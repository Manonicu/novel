(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["bookDetail"],{1253:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"book-detail scroll"},[a("div",{staticClass:"content"},[a("div",{staticClass:"info"},[a("div",{staticClass:"cover"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.data.detail.cover,expression:"data.detail.cover"}],attrs:{alt:t.data.detail.title}})]),a("div",{staticClass:"detail"},[a("div",{staticClass:"header"},[a("div",{staticClass:"title"},[t._v(t._s(t.data.detail.title))]),a("p",[a("span",[t._v(t._s(t.data.detail.author))]),t._v(t._s(t.data.detail.majorCate)+" ")])]),a("div",{staticClass:"count"},[t._v(t._s(t._f("count")(t.data.detail.wordCount)))])])]),a("div",{staticClass:"sub-info"},[a("div",{staticClass:"rate"},[a("span",[t._v(t._s(t.data.detail.rating.score.toFixed(1)+"分"))]),a("span",[t._v(t._s(t.data.detail.rating.count+"参与评论"))])]),a("div",{staticClass:"store"},[a("span",[t._v(t._s(t.data.detail.retentionRatio+"%"))]),a("span",[t._v("读者留存")])]),a("div",{staticClass:"follow"},[a("span",[t._v(t._s(t.data.detail.latelyFollower))]),a("span",[t._v("追书人气")])])]),a("div",{staticClass:"shortIntro"},[a("div",{staticClass:"title"},[t._v("简介")]),a("p",[t._v(t._s(t.data.detail.longIntro))])]),a("div",{staticClass:"categories",on:{click:function(e){t.showSelectSource=!t.showSelectSource}}},[a("span",[t._v("目录")]),a("span",[t._v("14小时前更新")]),a("span",[t._v(t._s(t.data.detail.lastChapter))]),a("Icon",{attrs:{name:"arrow-right",size:"sm"}})],1),a("div",{staticClass:"related"},[a("div",{staticClass:"title"},[t._v("本书追友还在读这些书")]),a("div",{staticClass:"items"},t._l(t.data.recommend,(function(e,n){return a("div",{key:n,staticClass:"item",on:{click:function(a){return t.goBook(e)}}},[a("div",{staticClass:"cover"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.cover,expression:"item.cover"}],attrs:{alt:e.title}})]),a("div",{staticClass:"name"},[t._v(t._s(e.title))])])})),0)]),t.data.other.length?a("div",{staticClass:"others"},[a("div",{staticClass:"title"},[t._v("作者的其他作品")]),a("div",{staticClass:"items"},t._l(t.data.other,(function(e,n){return a("div",{key:n,staticClass:"item",on:{click:function(a){return t.goBook(e)}}},[a("div",{staticClass:"cover"},[a("img",{attrs:{src:e.cover,alt:e.title}})]),a("div",{staticClass:"name"},[t._v(t._s(e.title))])])})),0)]):t._e()]),a("ActionSheet",{attrs:{title:"选择小说来源",actions:t.options},on:{select:t.$_selected},model:{value:t.showSelectSource,callback:function(e){t.showSelectSource=e},expression:"showSelectSource"}})],1)},i=[],o=(a("d81d"),a("0d03"),a("b0c0"),a("d3b7"),a("e25e"),a("25f0"),a("96cf"),a("68ef"),a("4d75"),a("09fe"),a("8400"),a("c31d")),s=a("2638"),r=a.n(s),c=a("d282"),l=a("ba31"),d=a("b1d2"),u=a("6605"),v=a("ad06"),f=a("e41f"),p=a("543e"),h=Object(c["a"])("action-sheet"),m=h[0],b=h[1];function g(t,e,a,n){var i=e.title,o=e.cancelText;function s(){Object(l["a"])(n,"input",!1),Object(l["a"])(n,"cancel")}function c(){if(i)return t("div",{class:[b("header"),d["a"]]},[i,t(v["a"],{attrs:{name:e.closeIcon},class:b("close"),on:{click:s}})])}function u(){if(a.default)return t("div",{class:b("content")},[a.default()])}function h(a,i){var o=a.disabled||a.loading;function s(t){t.stopPropagation(),a.disabled||a.loading||(a.callback&&a.callback(a),Object(l["a"])(n,"select",a,i),e.closeOnClickAction&&Object(l["a"])(n,"input",!1))}function r(){return a.loading?t(p["a"],{attrs:{size:"20px"}}):[t("span",{class:b("name")},[a.name]),a.subname&&t("span",{class:b("subname")},[a.subname])]}return t("button",{class:[b("item",{disabled:o}),a.className,d["d"]],style:{color:a.color},on:{click:s}},[r()])}function m(){if(o)return t("button",{class:b("cancel"),on:{click:s}},[o])}var g=e.description&&t("div",{class:b("description")},[e.description]);return t(f["a"],r()([{class:b(),attrs:{position:"bottom",round:e.round,value:e.value,overlay:e.overlay,duration:e.duration,lazyRender:e.lazyRender,lockScroll:e.lockScroll,getContainer:e.getContainer,closeOnClickOverlay:e.closeOnClickOverlay,safeAreaInsetBottom:e.safeAreaInsetBottom}},Object(l["b"])(n,!0)]),[c(),g,e.actions&&e.actions.map(h),u(),m()])}g.props=Object(o["a"])({},u["a"].props,{title:String,actions:Array,duration:Number,cancelText:String,description:String,getContainer:[String,Function],closeOnClickAction:Boolean,round:{type:Boolean,default:!0},closeIcon:{type:String,default:"close"},safeAreaInsetBottom:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0}});var C=m(g),_=(a("c3a6"),a("1fba")),y={name:"BookDetail",components:{Icon:v["a"],ActionSheet:C},data:function(){return{bookid:this.$route.query.bookid,data:{detail:{wordCount:0,rating:{score:0,count:0},retentionRatio:0},recommend:{},other:[],source:[]},loading:!1,error:!1,showSelectSource:!1}},watch:{bookid:{handler:function(t){var e=this;this.fetchData(t).then((function(){e.loading=!1}))},immediate:!0}},computed:{options:function(){var t=[];return this.data.source.map((function(e,a){t.push({name:e.name,value:a,_id:e._id})})),t}},created:function(){this.bscroll=null},filters:{count:function(t){return t&&t.toString().length>5?parseInt(t/1e4)+"万字":t+"字"}},methods:{fetchData:function(t){var e=this;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return this.loading=!0,this.error=!1,a.next=4,regeneratorRuntime.awrap(this.$axios.get("/detail?bookid=".concat(t)).then((function(t){1===t.data.result?(e.$emit("changeTitle",t.data.data.detail.title),e.$set(e,"data",t.data.data)):e.error=!0})));case 4:this.bscroll?this.bscroll.refresh():this.bscroll=new _["a"](".scroll",{scrollY:!0,bounceTime:800,click:!0,probeType:3});case 5:case"end":return a.stop()}}),null,this)},$_selected:function(t){var e=this;"优质书源"===t.name&&this.$dialog.confirm({title:"友情提示",message:"优质书源是追书神器官方Vip书源，无法阅读某些章节！",cancelText:"取消",confirmText:"确定"}).then((function(){e.$db.setData("current",{sourceValue:t.value}),e.$router.push({name:"category",query:{title:e.data.detail.title,sourceId:t._id}})}))},goBook:function(t){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.$db.setData("current",t));case 2:this.bookid=t._id;case 3:case"end":return e.stop()}}),null,this)}},beforeRouteLeave:function(t,e,a){this.bscroll&&this.bscroll.destroy(),this.$toast.clear(),a()}},k=y,S=(a("bfb5"),a("2877")),w=Object(S["a"])(k,n,i,!1,null,"dcc19e48",null);e["default"]=w.exports},4410:function(t,e,a){},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var n=a("1d80"),i=a("5899"),o="["+i+"]",s=RegExp("^"+o+o+"*"),r=RegExp(o+o+"*$"),c=function(t){return function(e){var a=String(n(e));return 1&t&&(a=a.replace(s,"")),2&t&&(a=a.replace(r,"")),a}};t.exports={start:c(1),end:c(2),trim:c(3)}},8400:function(t,e,a){},b0c0:function(t,e,a){var n=a("83ab"),i=a("9bf2").f,o=Function.prototype,s=o.toString,r=/^\s*function ([^ (]*)/,c="name";!n||c in o||i(o,c,{configurable:!0,get:function(){try{return s.call(this).match(r)[1]}catch(t){return""}}})},bfb5:function(t,e,a){"use strict";var n=a("4410"),i=a.n(n);i.a},d81d:function(t,e,a){"use strict";var n=a("23e7"),i=a("b727").map,o=a("1dde");n({target:"Array",proto:!0,forced:!o("map")},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},e25e:function(t,e,a){var n=a("23e7"),i=a("e583");n({global:!0,forced:parseInt!=i},{parseInt:i})},e41f:function(t,e,a){"use strict";var n=a("d282"),i=a("a142"),o=a("6605"),s=a("ad06"),r=Object(n["a"])("popup"),c=r[0],l=r[1];e["a"]=c({mixins:[o["a"]],props:{round:Boolean,duration:Number,closeable:Boolean,transition:String,safeAreaInsetBottom:Boolean,closeIcon:{type:String,default:"cross"},closeIconPosition:{type:String,default:"top-right"},position:{type:String,default:"center"},overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0}},beforeCreate:function(){var t=this,e=function(e){return function(a){return t.$emit(e,a)}};this.onClick=e("click"),this.onOpened=e("opened"),this.onClosed=e("closed")},render:function(){var t,e=arguments[0];if(this.shouldRender){var a=this.round,n=this.position,o=this.duration,r=this.transition||("center"===n?"van-fade":"van-popup-slide-"+n),c={};return Object(i["b"])(o)&&(c.transitionDuration=o+"s"),e("transition",{attrs:{name:r},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[e("div",{directives:[{name:"show",value:this.value}],style:c,class:l((t={round:a},t[n]=n,t["safe-area-inset-bottom"]=this.safeAreaInsetBottom,t)),on:{click:this.onClick}},[this.slots(),this.closeable&&e(s["a"],{attrs:{role:"button",tabindex:"0",name:this.closeIcon},class:l("close-icon",this.closeIconPosition),on:{click:this.close}})])])}}})},e583:function(t,e,a){var n=a("da84"),i=a("58a8").trim,o=a("5899"),s=n.parseInt,r=/^[+-]?0[Xx]/,c=8!==s(o+"08")||22!==s(o+"0x16");t.exports=c?function(t,e){var a=i(String(t));return s(a,e>>>0||(r.test(a)?16:10))}:s}}]);